<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordlePress</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            padding-top: 40px;
            font-family: sans-serif;
        }
        #app {
            max-width: 500px;
        }
        p {
            line-height: 1.3;
        }
        .guess-box {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 1px solid white;
            margin-right: 10px;
            background-color: #999;
        }
        .guess-box.orange {
            background-color: orange;
        }
        .guess-box.green {
            background-color: green;
        }
        form {
            margin-top: 20px;
        }
        input {
            width: 100px;
            margin-bottom: 5px;
        }
        button {
            display: block;
            width: 100px;
            margin-top: 5px;
        }
        .sponsor {
            margin-top: 40px;
            font-size: 0.9rem;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div x-data id="app">
        <h1>WordlePress</h1>
        <p>Stupid <em>very early</em> prototype: This is a Wordle-type game. It gives you a new random puzzle on page reload.</p>
        <p>You have to guess a WordPress core (PHP) function name that has 4 parts.<br>
        e.g. <code>wp_get_attachment_image</code></br>
        <p>The score logic isn't QUITE right yet. And I think it's just too darn hard. But have a go and <a href="https://twitter.com/magicroundabout">let me know what you think</a>.</p>

        <div class="guesses">
        <template x-for="guess in $store.state.guesses">
            <div class="guess">
                <span :class="{ 'guess-box': true, 'orange': guess[0] === 1, 'green': guess[0] === 2 }"></span>
                <span :class="{ 'guess-box': true, 'orange': guess[1] === 1, 'green': guess[1] === 2 }"></span>
                <span :class="{ 'guess-box': true, 'orange': guess[2] === 1, 'green': guess[2] === 2 }"></span>
                <span :class="{ 'guess-box': true, 'orange': guess[3] === 1, 'green': guess[3] === 2 }"></span>
                <span x-text="guess[4]"></span>
            </div>
        </template>
    </div>
    <form action="/">
        <input id="part0" type="text" name="part0" value="wp" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <code>_</code> <input id="part1" type="text" value="get" name="part1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <code>_</code> <input id="part2" type="text" value="attachment" name="part2" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <code>_</code> <input id="part3" type="text" value="image" name="part3" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <button @click.prevent="processGuess">Guess</button>
    </form>

    <div class="sponsor">
        If you like this, I also made <a href="https://turbo-admin.com">a browser extension</a> you might like!
    </div>
    <!-- Fathom - beautiful, simple website analytics -->
    <script src="https://cdn.usefathom.com/script.js" data-site="RQQYYYJA" defer></script>
    <!-- / Fathom -->
    <script src="https://unpkg.com/alpinejs" defer></script>
    <script src="funcs.js"></script>
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.store('state', {
                guesses: [],
                word: words[Math.floor(Math.random()*words.length)]
            });
        });

        function processGuess(e) {
            thisGuess = [0, 0, 0, 0];
            thisGuessedFunc = '';
            for (let i = 0; i < 4; i++) {
                const guessText = document.getElementById(`part${i}`).value.toLowerCase();
                if ( (Alpine.store('state').word).split('_').includes( guessText ) ) {
                    thisGuess[i] = 1;
                }
                if (guessText === (Alpine.store('state').word).split('_')[i]) {
                    thisGuess[i] = 2;
                }
                thisGuessedFunc += document.getElementById(`part${i}`).value + '_';
            }
            thisGuess[4] = thisGuessedFunc.substring(0, thisGuessedFunc.length-1);
            Alpine.store('state').guesses.push(thisGuess);
        }

        const word = words[1];
        const parts = word.split('_');

    </script>
</body>

</html>
